# Wild Duel - v3

## 1. 플러그인 컨셉

Wild Duel은 두 개의 월드를 기반으로 작동하는 팀 기반 PvP 게임 플러그인입니다.

- **로비 월드 (`wildduel_world`)**: 게임 대기, 팀 선택 등 모든 준비 과정을 진행하는 안전한 공간입니다. 이 월드는 플러그인에 의해 자동으로 생성 및 관리됩니다.
- **게임 월드 (`world`)**: 실제 파밍과 전투가 일어나는 주 무대입니다. 매 게임이 끝날 때마다 완전히 초기화되어, 항상 새롭고 공정한 환경을 제공합니다.

## 2. 게임 흐름

1.  **로비 (LOBBY)**
    - 모든 플레이어는 서버 접속 시 로비 월드로 자동 스폰됩니다.
    - 로비에서는 이동이 제한되며, 건축, 파괴 등의 활동이 불가능합니다.
    - 관리자는 이 단계에서 게임 설정을 하고, 플레이어는 팀을 선택합니다.

2.  **카운트다운 (COUNTDOWN)**
    - 관리자가 `/wd start` 명령어를 실행하면 10초 카운트다운이 시작됩니다.

3.  **파밍 (FARMING)**
    - 카운트다운이 끝나면, 로비에 있던 모든 플레이어는 게임 월드의 무작위 위치로 텔레포트됩니다.
    - 정해진 시간 동안 PvP는 비활성화되며, 플레이어들은 자유롭게 자원을 모으고 장비를 맞춥니다.

4.  **전투 (BATTLE)**
    - 파밍 시간이 종료되면 전투가 시작됩니다.
    - PvP가 활성화되고, 월드 보더가 점차 줄어들어 최후의 결전을 유도합니다.
    - 전투 중 사망한 플레이어는 관전자 모드로 전환됩니다.

5.  **종료 (ENDED)**
    - 최후의 한 팀이 남으면 게임이 종료되고 승리팀이 공지됩니다.
    - 잠시 후 모든 플레이어는 다음 게임을 위해 로비 월드로 자동 이동됩니다.

## 3. 명령어 목록

### 플레이어 명령어

- `/tpa <플레이어 이름>`
  - **설명**: 같은 팀에 소속된 다른 플레이어에게 텔레포트 요청을 보냅니다.
  - **사용 조건**: 파밍 또는 전투 단계에서만 사용 가능.

- `/tpacancel`
  - **설명**: 보낸 TPA 요청이 상대방에 의해 수락/거절되기 전에 취소합니다.

- `/tparesponse <accept|deny> <요청한 플레이어 이름>`
  - **설명**: 자신에게 온 TPA 요청을 수락하거나 거절합니다. `accept` 또는 `deny`를 통해 결정합니다.

- `/팀선택`
  - **설명**: 팀을 직접 선택할 수 있는 GUI를 엽니다.
  - **사용 조건**: 관리자가 '팀 자율 선택' 기능을 활성화했을 때, 그리고 게임이 시작되기 전(로비, 카운트다운)에만 사용 가능.

### 관리자 명령어 (OP 또는 `wildduel.admin` 권한 필요)

- `/wd admin`
  - **설명**: 게임의 모든 설정을 직관적으로 관리할 수 있는 관리자용 GUI를 엽니다.

- `/wd start`
  - **설명**: 로비 상태에서 게임 시작을 위한 10초 카운트다운을 실행합니다.

- `/wd reset confirm`
  - **설명**: **(주의!)** 현재 진행 중인 게임을 즉시 중단하고, 게임 월드(`world`)를 완전히 삭제하고 새로 생성합니다. 모든 플레이어는 로비로 이동되며, 플러그인의 모든 설정(팀, TPA 쿨타임 등)이 초기화됩니다.

- `/wd randomteam`
  - **설명**: 현재 접속 중인 모든 플레이어를 레드 팀과 블루 팀에 무작위로 배정합니다.

- `/wd st <초>`
  - **설명**: 파밍 단계에서 남은 시간을 실시간으로 늘리거나 줄입니다. 음수 값을 입력하면 시간이 감소합니다. (예: `/wd st 60` -> 60초 추가, `/wd st -30` -> 30초 감소)

- `/wd tparefresh <플레이어 이름|all>`
  - **설명**: 특정 플레이어 또는 서버 전체의 TPA 쿨타임을 즉시 초기화합니다.

- `/wd tpastatus <플레이어 이름>`
  - **설명**: 특정 플레이어에게 현재 남아있는 TPA 쿨타임이 몇 초인지 확인합니다.

- `/wd help`
  - **설명**: 관리자용 주요 명령어 목록을 보여줍니다.

## 4. 관리자 GUI 상세 기능 (`/wd admin`)

- **게임 시작**: `/wd start`와 동일한 기능.
- **랜덤 팀 배정**: `/wd randomteam`과 동일한 기능.
- **게임 초기화 정보**: 리셋 명령어(`reset confirm`)를 안내합니다. (실행은 명령어로만 가능)
- **팀 자율 선택 (토글)**: 플레이어가 `/팀선택` 명령어를 사용할 수 있게 할지 결정합니다.
- **자동 제련 (토글)**: 광물 채광 시 즉시 제련된 형태로 드랍될지 결정합니다.
- **수동 팀 배정**: 특정 플레이어를 원하는 팀(레드, 블루, 관전, 무소속)으로 설정하는 GUI를 엽니다.
- **TPA 쿨타임 초기화**: `/wd tparefresh all`과 동일한 기능.
- **남은 시간 실시간 조절**: 파밍 중에만 작동하며, 좌클릭(+60초)/우클릭(-60초)으로 남은 시간을 조절합니다.
- **총 파밍 시간 설정**: 게임 시작 전, 총 파밍 시간을 버튼으로 설정합니다.